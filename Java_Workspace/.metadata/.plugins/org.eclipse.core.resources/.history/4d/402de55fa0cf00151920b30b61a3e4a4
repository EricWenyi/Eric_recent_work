import edu.princeton.cs.algs4.StdRandom;
import edu.princeton.cs.algs4.StdStats;
import edu.princeton.cs.algs4.WeightedQuickUnionUF;

public class Percolation {
	private boolean[] open;
	private static int  n;
	private WeightedQuickUnionUF uf;
	
	private int mapto1D(int i, int j){
		if(i  == 0) i++;
		if(i == n+1) i--;
		if(j == 0) j++;
		if(j == n+1) j--;
		int num = (i - 1) * n + j - 1;
		return num;
	}
	
	private void valid(int i, int j){
		if(i > n || j > n || i < 1 || j < 1)
			throw new java.lang.IndexOutOfBoundsException();
	}
	
	public Percolation(int N){// create N-by-N grid, with all sites blocked
		
		if (N < 0) throw new IllegalArgumentException();
		for(int i = 0; i < N*N + 2; i++){//initialize open[]
			open[i] = false;
		}
		//open[n*n] = true;
		//open[n*n+1] = true;
		n = N;//initialize n
		uf = new WeightedQuickUnionUF(N*N + 2);//initialize uf
		
		for(int i= 0; i< N; i++){//initialize the virtual site
			uf.union(n*n,i);
			uf.union(n*n+1 , n*n - n + i );
		}	
	}
	
	public void open(int i, int j){// open site (row i, column j) if it is not open already
		valid(i,j);
		int num = mapto1D(i,j);
		if(open[num])
			return;
		else{
			open[num] = true;
			int check1 = mapto1D(i - 1,j);
			int check2 = mapto1D(i + 1,j);
			int check3 = mapto1D(i ,j - 1);
			int check4 = mapto1D(i ,j + 1); 
			if(open[check1]) uf.union(check1,num);
			if(open[check2]) uf.union(check2,num);
			if(open[check3]) uf.union(check3,num);
			if(open[check4]) uf.union(check4,num);
		}
		
	}
	
	public boolean isOpen(int i, int j){ // is site (row i, column j) open?
		valid(i,j);
		int num = mapto1D(i,j);
		if(open[num])
			return true;
		else
			return false;
	}
	
	public boolean isFull(int i, int j){// is site (row i, column j) full?
		valid(i,j);
		int num = mapto1D(i,j);
		if(uf.connected(n*n,num))
			return true;
		else
			return false;
	}
	
	public boolean percolates(){// does the system percolate?
		if(uf.connected(n*n, n*n+1))
			return true;
		else return false;
	}

	public static void main(String[] args){ // test client (optional)
		
	}
	
	
}
